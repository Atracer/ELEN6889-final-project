<html>
<head>
<title>xla.py</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
.s0 { color: #808080;}
.s1 { color: #a9b7c6;}
.s2 { color: #cc7832;}
.s3 { color: #6a8759;}
</style>
</head>
<body bgcolor="#2b2b2b">
<table CELLSPACING=0 CELLPADDING=5 COLS=1 WIDTH="100%" BGCOLOR="#606060" >
<tr><td><center>
<font face="Arial, Helvetica" color="#000000">
xla.py</font>
</center></td></tr></table>
<pre><span class="s0"># Copyright 2018 The JAX Authors.</span>
<span class="s0">#</span>
<span class="s0"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="s0"># you may not use this file except in compliance with the License.</span>
<span class="s0"># You may obtain a copy of the License at</span>
<span class="s0">#</span>
<span class="s0">#     https://www.apache.org/licenses/LICENSE-2.0</span>
<span class="s0">#</span>
<span class="s0"># Unless required by applicable law or agreed to in writing, software</span>
<span class="s0"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="s0"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="s0"># See the License for the specific language governing permissions and</span>
<span class="s0"># limitations under the License.</span>

<span class="s2">from </span><span class="s1">jax._src.interpreters.xla </span><span class="s2">import </span><span class="s1">(</span>
  <span class="s1">AxisEnv </span><span class="s2">as </span><span class="s1">AxisEnv</span><span class="s2">,</span>
  <span class="s1">TranslationContext </span><span class="s2">as </span><span class="s1">TranslationContext</span><span class="s2">,</span>
  <span class="s1">TranslationRule </span><span class="s2">as </span><span class="s1">TranslationRule</span><span class="s2">,</span>
  <span class="s1">abstractify </span><span class="s2">as </span><span class="s1">abstractify</span><span class="s2">,</span>
  <span class="s1">axis_groups </span><span class="s2">as </span><span class="s1">axis_groups</span><span class="s2">,</span>
  <span class="s1">backend_specific_translations </span><span class="s2">as </span><span class="s1">backend_specific_translations</span><span class="s2">,</span>
  <span class="s1">canonicalize_dtype </span><span class="s2">as </span><span class="s1">canonicalize_dtype</span><span class="s2">,</span>
  <span class="s1">canonicalize_dtype_handlers </span><span class="s2">as </span><span class="s1">canonicalize_dtype_handlers</span><span class="s2">,</span>
  <span class="s1">check_backend_matches </span><span class="s2">as </span><span class="s1">check_backend_matches</span><span class="s2">,</span>
  <span class="s1">parameter </span><span class="s2">as </span><span class="s1">parameter</span><span class="s2">,</span>
  <span class="s1">pytype_aval_mappings </span><span class="s2">as </span><span class="s1">pytype_aval_mappings</span><span class="s2">,</span>
  <span class="s1">register_collective_primitive </span><span class="s2">as </span><span class="s1">register_collective_primitive</span><span class="s2">,</span>
  <span class="s1">register_initial_style_primitive </span><span class="s2">as </span><span class="s1">register_initial_style_primitive</span><span class="s2">,</span>
  <span class="s1">register_translation </span><span class="s2">as </span><span class="s1">register_translation</span><span class="s2">,</span>
  <span class="s1">sharding_to_proto </span><span class="s2">as </span><span class="s1">sharding_to_proto</span><span class="s2">,</span>
  <span class="s1">translations </span><span class="s2">as </span><span class="s1">translations</span><span class="s2">,</span>
  <span class="s1">xla_call_p </span><span class="s2">as </span><span class="s1">_deprecated_xla_call_p</span><span class="s2">,</span>
  <span class="s1">xla_destructure </span><span class="s2">as </span><span class="s1">xla_destructure</span><span class="s2">,</span>
  <span class="s1">xla_shape_handlers </span><span class="s2">as </span><span class="s1">xla_shape_handlers</span><span class="s2">,</span>
  <span class="s1">device_put </span><span class="s2">as </span><span class="s1">_deprecated_device_put</span><span class="s2">,</span>
<span class="s1">)</span>

<span class="s2">from </span><span class="s1">jax._src.core </span><span class="s2">import </span><span class="s1">(</span>
  <span class="s1">ShapedArray </span><span class="s2">as </span><span class="s1">ShapedArray</span><span class="s2">,</span>
  <span class="s1">ConcreteArray </span><span class="s2">as </span><span class="s1">ConcreteArray</span><span class="s2">,</span>
<span class="s1">)</span>

<span class="s0"># TODO(phawkins): update users.</span>
<span class="s2">from </span><span class="s1">jax._src.dispatch </span><span class="s2">import </span><span class="s1">(</span>
  <span class="s1">apply_primitive </span><span class="s2">as </span><span class="s1">apply_primitive</span><span class="s2">,</span>
  <span class="s1">backend_compile </span><span class="s2">as </span><span class="s1">backend_compile</span><span class="s2">,</span>
<span class="s1">)</span>

<span class="s2">from </span><span class="s1">jax._src </span><span class="s2">import </span><span class="s1">xla_bridge </span><span class="s2">as </span><span class="s1">xb</span>
<span class="s2">from </span><span class="s1">jax._src.lib </span><span class="s2">import </span><span class="s1">xla_client </span><span class="s2">as </span><span class="s1">xc  </span><span class="s0"># type: ignore</span>

<span class="s1">_deprecated_Device = xc.Device</span>
<span class="s1">XlaOp = xc.XlaOp</span>
<span class="s1">xe = xc._xla</span>
<span class="s1">Backend = xe.Client</span>
<span class="s1">Buffer = xc.Buffer</span>
<span class="s1">_CppDeviceArray = xe.Buffer</span>

<span class="s2">from </span><span class="s1">jax._src.device_array </span><span class="s2">import </span><span class="s1">(</span>
  <span class="s1">make_device_array </span><span class="s2">as </span><span class="s1">make_device_array</span><span class="s2">,</span>
  <span class="s1">_DeviceArray </span><span class="s2">as </span><span class="s1">_DeviceArray</span><span class="s2">,</span>
  <span class="s1">DeviceArray </span><span class="s2">as </span><span class="s1">_deprecated_DeviceArray</span><span class="s2">,</span>
<span class="s1">)</span>

<span class="s1">_deprecations = {</span>
    <span class="s0"># Added Feb 9, 2023:</span>
    <span class="s3">&quot;Device&quot;</span><span class="s1">: (</span>
        <span class="s3">&quot;jax.interpreters.xla.Device is deprecated. Use jax.Device instead.&quot;</span><span class="s2">,</span>
        <span class="s1">_deprecated_Device</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;DeviceArray&quot;</span><span class="s1">: (</span>
        <span class="s1">(</span>
            <span class="s3">&quot;jax.interpreters.xla.DeviceArray is deprecated. Use jax.Array&quot;</span>
            <span class="s3">&quot; instead.&quot;</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">_deprecated_DeviceArray</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;device_put&quot;</span><span class="s1">: (</span>
        <span class="s1">(</span>
            <span class="s3">&quot;jax.interpreters.xla.device_put is deprecated. Please use&quot;</span>
            <span class="s3">&quot; jax.device_put instead.&quot;</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">_deprecated_device_put</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
    <span class="s3">&quot;xla_call_p&quot;</span><span class="s1">: (</span>
        <span class="s1">(</span>
            <span class="s3">&quot;jax.interpreters.xla.xla_call_p is deprecated. Please use&quot;</span>
            <span class="s3">&quot; jax.experimental.pjit.pjit_p instead.&quot;</span>
        <span class="s1">)</span><span class="s2">,</span>
        <span class="s1">_deprecated_xla_call_p</span><span class="s2">,</span>
    <span class="s1">)</span><span class="s2">,</span>
<span class="s1">}</span>

<span class="s2">from </span><span class="s1">jax._src.deprecations </span><span class="s2">import </span><span class="s1">deprecation_getattr </span><span class="s2">as </span><span class="s1">_deprecation_getattr</span>
<span class="s1">__getattr__ = _deprecation_getattr(__name__</span><span class="s2">, </span><span class="s1">_deprecations)</span>
<span class="s2">del </span><span class="s1">_deprecation_getattr</span>

<span class="s2">import </span><span class="s1">typing</span>
<span class="s2">if </span><span class="s1">typing.TYPE_CHECKING:</span>
  <span class="s1">Device = xc.Device</span>
  <span class="s2">from </span><span class="s1">jax._src.device_array </span><span class="s2">import </span><span class="s1">(</span>
    <span class="s1">DeviceArray </span><span class="s2">as </span><span class="s1">DeviceArray</span><span class="s2">,</span>
  <span class="s1">)</span>
  <span class="s2">from </span><span class="s1">jax._src.interpreters.xla </span><span class="s2">import </span><span class="s1">(</span>
      <span class="s1">device_put </span><span class="s2">as </span><span class="s1">device_put</span><span class="s2">,</span>
  <span class="s1">)</span>
  <span class="s2">from </span><span class="s1">jax._src.interpreters.xla </span><span class="s2">import </span><span class="s1">xla_call_p </span><span class="s2">as </span><span class="s1">xla_call_p</span>
<span class="s2">del </span><span class="s1">typing</span>
</pre>
</body>
</html>